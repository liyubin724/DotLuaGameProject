local oop = require('DotLua/OOP/oop')
local System = oop.using('DotLua/ECS/Systems/System')

local MessageSystem =
    oop.class(
    'DotLua.ECS.Systems.MessageSystem',
    function(self, dispatcher)
        self.dispatcher = dispatcher
    end,
    System
)

function MessageSystem:onActivate()
    local eventNames = self:listEventNames()
    if eventNames and #(eventNames) > 0 and self.dispatcher then
        for _, name in ipairs(eventNames) do
            self.dispatcher:RegistListener(name, self, self.handleEvent)
        end
    end
end

function MessageSystem:listEventNames()
    return nil
end

function MessageSystem:handleEvent(eventName, ...)
    if self.isEnable then
        self:onEvent(eventName, ...)
    end
end

function MessageSystem:onDeactivate()
    local eventNames = self:listEventNames()
    if eventNames and #(eventNames) > 0 and self.dispatcher then
        for _, name in ipairs(eventNames) do
            self.dispatcher:UnregistListener(name, self, self.handleEvent)
        end
    end
end

function MessageSystem:onEvent(eventName, ...)
end

return MessageSystem
