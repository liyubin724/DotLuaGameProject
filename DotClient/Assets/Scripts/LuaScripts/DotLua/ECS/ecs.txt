local oop = require("DotLua/OOP/oop")
local ECSEnv = require("DotLua/ECS/ECSEnv")

ecs = ecs or {}

ecs.env = nil
ecs.GetEnv = function()
    return ecs.env
end

ecs.GetContexts = function()
    if ecs.env then
        return ecs.env:GetContexts()
    end

    return nil
end

ecs.GetSystems = function()
    if ecs.env then
        return ecs.env:GetSystems()
    end
    return nil
end

ecs.GetCollectionEntity = function()
    local contexts = ecs.GetContexts()
    if contexts then
        return contexts:GetCollectionEntity()
    end

    return nil
end

ecs.GetGlobalEntity = function(name)
    local contexts = ecs.GetContexts()
    if contexts then
        return contexts:GetOrCreateGlobalEntity(name)
    end

    return nil
end

ecs.Initialize = function(envClass)
    envClass = envClass or ECSEnv
    ecs.env = envClass()
    ecs.env:DoInitlize()
end

ecs.Update = function(deltaTime, unscaleDeltaTime)
    if ecs.env then
        ecs.env:DoUpdate(deltaTime, unscaleDeltaTime)
    end
end

ecs.LateUpdate = function(deltaTime, unscaleDeltaTime)
    if ecs.env then
        ecs.env:DoLateUpdate(deltaTime, unscaleDeltaTime)
    end
end

ecs.Destroy = function()
    if ecs.env then
        ecs.env:DoDestroy()
    end
    ecs.env = nil
end

oop.asreadonly(ecs)
