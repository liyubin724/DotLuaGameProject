local oop = require('DotLua/OOP/oop')
local Matcher = require('DotLua/ECS/Matchers/Matcher')
local Component = require("DotLua/ECS/Core/Component")

local LogTag = "HaveAllComponentMatcher"

local HaveAnyComponentMatcher =
    oop.class(
    'DotLua.ECS.Matchers.Components.HaveAnyComponentMatcher',
    function(self, componentClasses)
        if oop.isDebug then
            if not componentClasses then
                oop.error(LogTag, "the classes is nil")
                return
            end
            for _, componentClass in ipairs(componentClasses) do
                if not componentClass or oop.isclassof(componentClass, Component) then
                    oop.error(LogTag, "the class is not a subclass of Component")
                    return
                end
            end
        end

        self.componentClasses = componentClasses
    end,
    Matcher
)

function HaveAnyComponentMatcher:IsMatch(entity)
    if not self.componentClasses or #self.componentClasses == 0 then
        return false
    end

    return entity:HasAnyComponent(self.componentClasses)
end

return HaveAnyComponentMatcher
