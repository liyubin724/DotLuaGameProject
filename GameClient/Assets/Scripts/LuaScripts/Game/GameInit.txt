local oop = require('DotLua/OOP/oop')
local Logger = require('DotLua/Debug/Logger')
local HTimer = require('DotLua/Timer/HierarchicalTimer')
local CycleTime = require('DotLua/CycleTime')

local DELogUtil = CS.DotEngine.Log.LogUtil

if _G.isDebug then
    require('Debugger/LuaPanda').start('127.0.0.1', 8818)
    Logger.SetEnable(true, true, true)
else
    Logger.SetEnable(false, false, true)
end
Logger.SetFunc(DELogUtil.Info, DELogUtil.Warning, DELogUtil.Error)

_G.gameLauncher = {}

_G.gameLauncher.DoStart = function()
    require('Game/ECS/GameECS')
    _G.gameECS:DoInitialize()

    local rapidjson = require("rapidjson")
    local t = {
        a = 1,
        b = {"A","B","C"},
        c = "SSSS"
    }
    local tJson = rapidjson.encode(t)
    oop.info("rapidjson",tJson)
end

_G.gameLauncher.DoUpdate = function(deltaTime, unscaleDeltaTime)
    CycleTime.DoUpdate(deltaTime, unscaleDeltaTime)
    _G.gameECS:DoUpdate()
end

_G.gameLauncher.DoLateUpdate = function()
    _G.gameECS:DoLateUpdate()
end

_G.gameLauncher.DoDestroy = function()
    _G.gameECS:DoTeardown()
    _G.gameECS = nil
end
