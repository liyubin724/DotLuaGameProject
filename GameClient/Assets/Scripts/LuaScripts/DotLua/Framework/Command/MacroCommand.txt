local SimpleCommand = require('DotLua/Framework/Command/SimpleCommand')

local MacroCommand =
    class(
    SimpleCommand,
    function(self)
        self.subCommands = {}
        self:OnInitialized()
    end,
    'MacroCommand'
)

function MacroCommand:OnInitialized()
end

function MacroCommand:AddSubCommand(commandClass)
    if isclass(commandClass) then
        table.insert(self.subCommands, commandClass)
    else
        error('')
    end
end

function MacroCommand:Execute(notification)
    while #(self.subCommands) > 0 do
        local commandClass = table.remove(self.subCommands, 1)
        if commandClass then
            local command = commandClass()
            command:OnInitialized(self:GetUniqueID())
            command:Execute(notification)
        else
            error('')
        end
    end
end

return MacroCommand
