local Notifier = require('DotLua/Framework/Observer/Notifier')

local MacroCommand =
    class(
    Notifier,
    function(self,key)
        self.subcommandCreator = {}
        self:OnInitialized()
    end
)

function MacroCommand:OnInitialized()
end

function MacroCommand:AddSubCommand(commandCreatorFunc)
    if type(commandCreatorFunc) == 'function' then
        table.insert(self.subcommandCreator, commandCreatorFunc)
    else
        error('')
    end
end

function MacroCommand:Execute(notification)
    while #(self.subcommandCreator) > 0 do
        local creatorFunc = self.subcommandCreator[1]
        if creatorFunc then
            local command = creatorFunc()
            command:OnInitialized(self:GetKey())
            command:Execute(notification)
            table.remove(self.subcommandCreator, 1)
        else
            error('')
        end
    end
end

return MacroCommand